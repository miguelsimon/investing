import{i as S}from"./navigation-CXrC8Ner.js";import{f as k,g as P,a as C,r as x,b as E,c as I}from"./problemView-DNxSRx9J.js";S("overview");async function v(){const c=document.getElementById("status"),i=document.getElementById("summary"),r=document.getElementById("chart-section"),o=document.getElementById("growth-chart");if(!(!c||!i))try{const s=await k();c.textContent="Problem data loaded.";const u=P(s),b=new Set(u);let a=[];console.debug("[overview] problem loaded",{tickers:u.length});let l=null;const h=()=>{var e;if(l&&((e=globalThis.Plotly)!=null&&e.purge))try{globalThis.Plotly.purge(l)}catch(t){console.warn("[overview] failed to purge chart host",t)}l=null},m=(e,t)=>{o&&(h(),o.innerHTML="",o.append(document.createTextNode(e)),r&&(r.hidden=!1),console.debug("[overview] chart disabled",{reason:t,selectedTickers:a}))};let g=!1;const w=()=>{if(g||!o)return;const e=()=>{var t,n;(n=(t=globalThis.Plotly)==null?void 0:t.Plots)!=null&&n.resize&&l&&globalThis.Plotly.Plots.resize(l)};window.addEventListener("resize",e,{passive:!0}),g=!0},y=()=>{if(!o||!r)return;if(console.debug("[overview] updateChart invoked",{selectedTickers:a}),!a.length){m("Select at least one ticker to display the chart.","no-selection");return}const e=C(s,a);if(!e){m("Selected tickers do not share a common date range without missing data.","range-missing");return}console.debug("[overview] rendering chart",{range:e}),h(),o.innerHTML="";const t=document.createElement("div");if(t.className="growth-chart-host",o.append(t),x(t,s,{tickers:a,startIndex:e.startIndex,endIndex:e.endIndex})===null){r.hidden=!1,console.debug("[overview] renderGrowthChart returned null");return}l=t,r.hidden=!1,w(),console.debug("[overview] chart rendered")},p=e=>{if(!Array.isArray(e))return[];const t=[],n=new Set;for(const d of e)!b.has(d)||n.has(d)||(t.push(d),n.add(d));return t},f=(e,t="unknown")=>{const n=p(e);console.debug("[overview] setSelectedTickers",{source:t,requested:e,normalized:n}),a=n,y()},T=E(s);f(T,"initial"),I(i,s,{selectedTickers:[...a],onSelectionChange:e=>{console.debug("[overview] selection change from summary",{tickerList:e}),f(e,"summary")}}),i.hidden=!1}catch(s){c.textContent=`Unable to load problem data. ${s.message}`,i.hidden=!0,r&&(r.hidden=!0)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();
