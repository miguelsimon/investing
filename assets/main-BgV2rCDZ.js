import{i as T}from"./navigation-CXrC8Ner.js";import{f as k,g as P,a as S,r as C,b as x}from"./problemView-CE_Qh1M0.js";T("overview");async function v(){const c=document.getElementById("status"),i=document.getElementById("summary"),r=document.getElementById("chart-section"),o=document.getElementById("growth-chart");if(!(!c||!i))try{const a=await k();c.textContent="Problem data loaded.";const u=P(a),b=new Set(u);let s=[];console.debug("[overview] problem loaded",{tickers:u.length});let d=null;const h=()=>{var e;if(d&&((e=globalThis.Plotly)!=null&&e.purge))try{globalThis.Plotly.purge(d)}catch(t){console.warn("[overview] failed to purge chart host",t)}d=null},m=(e,t)=>{o&&(h(),o.innerHTML="",o.append(document.createTextNode(e)),r&&(r.hidden=!1),console.debug("[overview] chart disabled",{reason:t,selectedTickers:s}))};let g=!1;const w=()=>{if(g||!o)return;const e=()=>{var t,n;(n=(t=globalThis.Plotly)==null?void 0:t.Plots)!=null&&n.resize&&d&&globalThis.Plotly.Plots.resize(d)};window.addEventListener("resize",e,{passive:!0}),g=!0},y=()=>{if(!o||!r)return;if(console.debug("[overview] updateChart invoked",{selectedTickers:s}),!s.length){m("Select at least one ticker to display the chart.","no-selection");return}const e=S(a,s);if(!e){m("Selected tickers do not share a common date range without missing data.","range-missing");return}console.debug("[overview] rendering chart",{range:e}),h(),o.innerHTML="";const t=document.createElement("div");if(t.className="growth-chart-host",o.append(t),C(t,a,{tickers:s,startIndex:e.startIndex,endIndex:e.endIndex})===null){r.hidden=!1,console.debug("[overview] renderGrowthChart returned null");return}d=t,r.hidden=!1,w(),console.debug("[overview] chart rendered")},p=e=>{if(!Array.isArray(e))return[];const t=[],n=new Set;for(const l of e)!b.has(l)||n.has(l)||(t.push(l),n.add(l));return t},f=(e,t="unknown")=>{const n=p(e);console.debug("[overview] setSelectedTickers",{source:t,requested:e,normalized:n}),s=n,y()};f(u,"initial"),x(i,a,{selectedTickers:[...s],onSelectionChange:e=>{console.debug("[overview] selection change from summary",{tickerList:e}),f(e,"summary")}}),i.hidden=!1}catch(a){c.textContent=`Unable to load problem data. ${a.message}`,i.hidden=!0,r&&(r.hidden=!0)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();
