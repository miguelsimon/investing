function p(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $(n){if(!n)return"";let o="",e=0;for(;e<n.length;){const a=n[e];if(a==="`"){const r=n.indexOf("`",e+1);if(r===-1){o+=p(n.slice(e));break}const t=n.slice(e+1,r);o+=`<code>${p(t)}</code>`,e=r+1;continue}if(a==="["){const r=n.indexOf("]",e+1);if(r!==-1&&n[r+1]==="("){const t=n.indexOf(")",r+2);if(t!==-1){const f=n.slice(e+1,r),d=n.slice(r+2,t),s=p(f),u=d.replace(/"/g,"%22");o+=`<a href="${u}" target="_blank" rel="noopener noreferrer">${s}</a>`,e=t+1;continue}}}const i=n.indexOf("`",e),l=n.indexOf("[",e);let c=-1;if(i!==-1&&l!==-1?c=Math.min(i,l):c=Math.max(i,l),c===-1){o+=p(n.slice(e));break}if(c===e){o+=p(n[e]),e+=1;continue}o+=p(n.slice(e,c)),e=c}return o}function k(n){const o=n.trim();if(!o)return"";const e=o.split(/\n/),a=e.every(s=>/^> ?/.test(s)||s===""),i=e.map(s=>s.replace(/^> ?/,"")),l=[];let c=[],r=null;function t(){const s=c.join(" ").trim();s&&l.push(`<p>${$(s)}</p>`),c=[]}function f(){if(!r||r.items.length===0){r=null;return}const s=r.items.map(h=>`<li>${h}</li>`).join(""),u=r.type==="ol"?"ol":"ul";l.push(`<${u}>${s}</${u}>`),r=null}i.forEach(s=>{const u=s.trim();if(u===""){t(),f();return}const h=u.match(/^(\d+)\.\s+(.*)$/),m=u.match(/^[-*]\s+(.*)$/);if(h||m){t();const g=h?"ol":"ul";(!r||r.type!==g)&&(f(),r={type:g,items:[]});const B=h?h[2]:m[1];r.items.push($(B.trim()));return}f(),c.push(u)}),t(),f();const d=l.join("");return a?`<blockquote>${d}</blockquote>`:d}function b(n){const o=[];let e=[],a=[],i=!1;function l(){const t=e.join(`
`).trim();if(!t){e=[];return}t.split(/\n\s*\n/).map(f=>f.trim()).filter(Boolean).forEach(f=>o.push({type:"text",content:f})),e=[]}function c(){const t=a.join(`
`);o.push({type:"code",content:p(t)}),a=[]}return String(n??"").replace(/\r/g,"").split(`
`).forEach(t=>{if(/^\s*```/.test(t)){i?(c(),i=!1):(l(),i=!0);return}i?a.push(t):e.push(t)}),i&&c(),l(),o.map(t=>t.type==="code"?`<pre><code>${t.content}</code></pre>`:k(t.content)).join("").trim()}export{p as e,b as r};
